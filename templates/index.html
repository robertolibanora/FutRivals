{% extends "base.html" %}

{% block content %}
<script>
  // Funzione per generare una stringa breve alfanumerica di 5 caratteri
  function generateShortId(length = 5) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let result = '';
    for (let i = 0; i < length; i++) {
      result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
  }
  // Imposta il cookie se non esiste (solo homepage)
  function setUserIdCookie() {
    if (!document.cookie.split('; ').find(row => row.startsWith('user_id='))) {
      var shortId = generateShortId();
      var expires = new Date();
      expires.setFullYear(expires.getFullYear() + 1); // 1 anno
      document.cookie = 'user_id=' + shortId + '; expires=' + expires.toUTCString() + '; path=/; SameSite=Lax';
    }
  }
  setUserIdCookie();
</script>
<section class="hero">
    <h1>FUT RIVALS TOURNAMENT</h1>
    <div class="card">
    {% if next_match %}
        <h2>Prossima Partita</h2>
        <div class="match-info team-logos-flex" style="flex-direction:column;align-items:center;gap:1.2em;">
            <div class="team home" style="font-size:1.25em;">{{ next_match.squadra_casa }}</div>
            <div class="logo">
                <img class="team-logo-big" src="{{ url_for('static', filename='squadre/' + next_match.logo_casa) }}" alt="{{ next_match.squadra_casa }}">
            </div>
            <div class="vs vs-neon">VS</div>
            <div class="logo">
                <img class="team-logo-big" src="{{ url_for('static', filename='squadre/' + next_match.logo_trasferta) }}" alt="{{ next_match.squadra_trasferta }}">
            </div>
            <div class="team away" style="font-size:1.25em;">{{ next_match.squadra_trasferta }}</div>
        </div>
        <div class="match-details">
            <p class="date">{{ next_match.data }}</p>
            <p class="time">{{ next_match.ora[:5] }}</p>
            <p class="stadium">{{ next_match.stadio }}</p>
            {% if next_match.tipo_partita %}
              <p class="tipo-partita">{{ next_match.tipo_partita }}</p>
            {% endif %}
            {% if next_match.risultato and next_match.risultato != '-' %}
              <p class="score">{{ next_match.risultato }}</p>
            {% endif %}
        </div>
    {% else %}
        <h2>Nessuna partita programmata</h2>
    {% endif %}
    </div>
</section>

<section class="top-scorers">
    <div class="card">
        <h2>Top 5 Cannonieri</h2>
        {% if top_scorers and top_scorers|length > 0 %}
        <table style="width:100%;text-align:center;">
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Giocatore</th>
                    <th>Squadra</th>
                    <th>Goal</th>
                </tr>
            </thead>
            <tbody>
                {% for p in top_scorers %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ p['Giocatore'] }}</td>
                    <td>{{ p['Squadra'] }}</td>
                    <td>{{ p['Goal'] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>Nessun dato disponibile.</p>
        {% endif %}
    </div>
</section>

<section class="sponsors">
    <h2>I Nostri Sponsor</h2>
    <div class="sponsor-carousel">
        <div class="sponsor-track">
            <!-- Sponsor attuali -->
            <div class="sponsor">
                <img src="{{ url_for('static', filename='sponsors/sponsor2.png') }}" alt="Milan Noleggi">
            </div>
            <div class="sponsor">
                <img src="{{ url_for('static', filename='sponsors/sponsor1.png') }}" alt="Sarto SRL">
            </div>
            <div class="sponsor">
                <img src="{{ url_for('static', filename='sponsors/sponsor3.png') }}" alt="Delta Maris">
            </div>
            <!-- AGGIUNGI QUI ALTRI SPONSOR SOLO SE ESISTONO NELLA CARTELLA static/sponsors/ -->
        </div>
    </div>
</section>
{% endblock %}